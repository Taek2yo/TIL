# 브라우저 렌더링

### 브라우저 렌더링 이란?
> 웹 페이지를 사용자에게 시각적으로 표시하기 위한 복잡한 과정. 이 과정은 웹 브라우저가 HTML 및 CSS로 작성된 웹 페이지를 해석하고, 화면에 그려 사용자가 볼 수 있도록 하는 핵심 역할을 한다.

### 렌더링 프로세스의 중요성

웹 페이지가 빠르게 로드되고 렌더링되면 UX를 향상시킬 수 있으며, 반대로 렌더링이 느리거나 블로킹되면 UX는 낮아진다. 

브라우저 렌더링 프로세스를 자세히 이해하면 웹 페이지를 더 빠르게 렌더링하고 사용자에게 더 나은 경험을 제공할 수 있으므로, 중요한 주제 중 하나이다.


## 브라우저의 주요 구성 요소
![브라우저 주요 구성요소](https://github.com/Taek2yo/TIL/assets/110080748/7aac841d-48b3-4da7-bdf8-d02ff30bfb1f)
출처 : https://haileychoi15.medium.com/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%98%EB%82%98%EC%9A%94-c135390641ad

* 사용자 인터페이스(User Interface)
> 주소 표시줄, 이전 / 다음 / 새로고침 버튼, 북마크 등 브라우저에서 랜더링되는 화면을 제외한 부분.

* 브라우저 엔진
> 웹 페이지 로딩 및 표시를 제어하는 핵심 엔진.

* 렌더링 엔진
> HTML과 CSS를 해석하고 페이지를 렌더링하는 역할.

* JS 해석기(JavaScript Interpreter)
> JS 해석기가 자바스크립트 코드를 해석.
  
* UI 백엔드(UI Backend) 
> windows/combo boxes 같은 베이직한 위젯 컴포넌트를 그리는 역할.

* 통신(Networking)
> HTTP 요청과 관련된 네트워킹 기능을 담당.

* 데이터 저장소(Data Persistence)
> 데이터를 저장하는 역할을 하며 로컬 스토리지 타입과 쿠키 타입으로 나눌 수 있다.

## 렌더링 프로세스 단계
### 1. 문서 파싱
- HTML 파싱
  - 웹 페이지의 구조를 이해하기 위해 HTML 문서 해석
- CSS 파싱
  - 스타일 정보를 분석하여 렌더링 규칙 생성
- DOM 트리 구축
  - 파서를 통해 HTML 문서를 파싱하여 Document Object Model (DOM) 트리 생성
- CSSOM 트리 구축
  - CSS 파싱 결과를 통해 CSS Object Model (CSSOM) 트리 생성

### 2. 스타일 계산
- 스타일 규칙 적용
  - 요소에 대한 스타일 규칙을 적용하여 계산된 스타일 생성
- 계산된 스타일 생성
  - 각 요소의 최종 스타일 정보 계산

### 3. 레이아웃
- 레이아웃 단계에서의 요소 배치
  - 각 요소의 크기와 위치 결정
- 블록 레이아웃과 인라인 레이아웃
  - 웹 페이지 레이아웃을 위해 블록 및 인라인 박스 구분
- 배치 및 위치 계산
  - 요소의 위치를 계산하여 화면에 배치

### 4. 페인팅
- 렌더 트리를 사용하여 화면에 그리기
  - 렌더 트리를 통해 화면에 그래픽 업데이트 수행
- 레이아웃과 스타일 정보를 이용하여 그래픽 업데이트
  - 최종 화면 구성을 생성하여 사용자에게 표시

#### 위의 내용을 그림으로 표시하면 이렇다.
![렌더링과정](https://github.com/Taek2yo/TIL/assets/110080748/0977071b-ce6c-4ce3-9290-02c38ff3e95f)

## 리플로우와 리페인트

### 리플로우(Reflow)란?
> 레이아웃 변경으로 인해 전체 렌더링 프로세스 재실행

### 리페인트(Repaint)란?
> 스타일 변경으로 인해 일부만 다시 그리는 과정

### 최적화 방법
> 리플로우와 리페인트 최소화를 위한 최적화 전략

## 자바스크립트와 브라우저 렌더링

### 자바스크립트의 렌더링 차단

웹 페이지에서 자바스크립트 코드가 실행되는 동안에는 렌더링 프로세스가 차단될 수 있다. 이로 인해 사용자가 페이지를 느리게 또는 부드럽게 인식할 수 있으며, 웹 페이지의 성능 문제를 야기할 수 있다.
### 자바스크립트의 렌더링 차단을 방지하기 위한 해결책
- 비동기 스크립트 로딩을 활용하여 페이지 로딩과 자바스크립트 실행을 병렬 처리.
- 자바스크립트 코드를 최적화하고 불필요한 연산을 줄인다.
- 스크립트를 페이지 하단으로 이동하여 중요한 콘텐츠가 먼저 렌더링되도록 한다.

### 비동기 스크립트 로딩

비동기 스크립트 로딩을 통해 페이지 로딩과 자바스크립트 실행을 병렬로 처리하므로 사용자는 더 빠른 페이지 로드와 더 높은 반응성을 경험할 수 있다.
### 비동기 스크립트 로딩 구현방법 
- `async` 속성을 이용하여 스크립트를 비동기로 로드.
- `defer` 속성을 사용하여 스크립트를 페이지 파싱이 완료된 후에 실행한다.
- 동적으로 스크립트를 로드하고 실행한다.

## 성능 최적화

### 렌더링 성능 개선을 위한 팁

* 이미지 최적화 
> 이미지의 크기를 최적화하고, 적절한 이미지 포맷을 선택하여 대역폭을 절약.
* CSS 압축
> CSS 파일을 압축하여 파일 크기를 줄이고 다운로드 시간을 단축한다.
* 렌더링 지연 최소화
> 자바스크립트 코드를 최적화하고, 렌더링을 차단하는 작업을 최소화한다.

### 웹 성능 최적화 도구

웹 성능을 모니터링하고 최적화하는 데 도움을 주는 도구를 활용 가능하다.

[Google PageSpeed Insights](https://pagespeed.web.dev/)
> 웹 페이지 성능을 분석하고 최적화 권고 사항을 제공.

[GTmetrix](https://gtmetrix.com/)
> 웹 페이지 로딩 시간을 측정하고 성능 향상을 위한 가이드를 제공.

웹 개발자 도구(웹 브라우저 > F12)
> 브라우저 내장 개발 도구를 활용하여 웹 페이지의 성능을 분석하고 디버깅할 수 있다.

웹 개발자 도구 사용시 참고하면 좋은 것들
* [구글 크롬(Chrome) 개발자 도구 이용해서 Javascript 메모리 관리하는 방법](https://mainia.tistory.com/5140)
* [자바스크립트 크롬 브라우저로 디버깅 하는 방법](https://mainia.tistory.com/2801)

## 결론

### 브라우저 렌더링 간단 요약
1. **문서 파싱**
<br/>: HTML과 CSS 문서를 파싱하고 DOM 트리와 CSSOM 트리를 구축합니다.

2. **스타일 계산**
<br/>: 각 요소에 계산된 스타일을 적용합니다.

3. **레이아웃**
<br/> 요소의 크기와 위치를 계산하여 페이지 레이아웃을 생성합니다.

4. **페인팅**
<br/>: 렌더 트리를 사용하여 화면에 그리고 사용자에게 표시합니다.

### 브라우저 렌더링이 왜 중요할까?
> 웹 페이지에 빠른 로딩과 원활한 렌더링을 UX를 향상 시킬 수 있는 중요한 요소이다. 그러므로 개발자는 렌더링 프로세스를 잘 이해하고 최적화하는 것이 중요하다.

### 더 나은 사용자 경험을 위한 고려 사항
> 웹 페이지 성능 최적화, 비동기 스크립트 로딩, 이미지 최적화, CSS 압축 등 다양한 기술과 전략을 사용하여 UX를 향상시킬 수 있다. 


#### 출처 및 참고
https://haileychoi15.medium.com/%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80%EB%8A%94-%EC%96%B4%EB%96%BB%EA%B2%8C-%EB%8F%99%EC%9E%91%ED%95%98%EB%82%98%EC%9A%94-c135390641ad

https://velog.io/@grinding_hannah/Web-%EB%B8%8C%EB%9D%BC%EC%9A%B0%EC%A0%80-%EC%9E%91%EB%8F%99-%EC%9B%90%EB%A6%AC

https://www.youtube.com/watch?v=oLC_QYPmtS0